[English](Q&A.md) | 简体中文

# **干掉预装软件 / Bloatware Slayer**
一个无需修改 system 分区即可移除预装软件的 Magisk 模块 / A Magisk module to remove bloatware systemlessly

# 问与答 / Question and Answer

## Q: 为什么需要我手工复制应用目录名，而不是模块根据我指定的应用名称或包名自行检测？

### A: 1. **应用名称和包名并不可靠，依靠这两点查找应用目录的效率太低了**。
对于大多数规范的ROM而言，用除了英文以外的其他语言给系统目录命名的概率极低，甚至有不少应用的应用名称跟其所在的系统目录名没有任何关系（无论是ROM提供商的疏忽和学艺不精导致的命名细节不规范，还是为了隐藏自己收集用户信息安插的眼线APP的阴暗心思而故意不规范命名）。如果一定要这么匹配，且不说需要大量的数据统计，即使如此，误判率也还是很高。
> 举个例子：有个APP名为系统服务，但是其目录名为AdPushService，其包名为com.android.adpromote
### 2. **至于包名，目前已确认不会添加，原因如下：
1) 该功能需要添加额外的内置组件：aapt，这会增大维护难度
2) 即使添加了aapt，对基于AOSP的ROM还好说，对于HyperOS、MIUI这类原厂系统动辄100多甚至200多系统应用的来说，逐个扫描apk的包名会严重拖累系统启动速度并消耗大量资源
3) 既然都能拿到包名了，拿到所在的资源目录自然也不难，添加包名检测事实上也并没有多方便
### 3. **手动添加是为了确定添加这些预装应用目录是出自用户自身的意志和选择，最起码不是完全没考虑过自己在做什么的鲁莽行为**。
虽然该模块是在 Systemless (不修改系统) 的情况下运行，但是**你始终需要知道并确定自己正在做的事情**。你必须知道自己屏蔽掉了哪些系统 APP，**而不是照搬别人的列表，出问题了就把责任全部推给本 Magisk 模块**。

## Q: Bloatware Slayer 会破坏我的设备吗？为什么需要救砖手段？

### A: 1. **模块本身并不会直接修改系统，一旦禁止或卸载本模块，所有的更改均会被还原**，你的系统也不会受到任何损害，正所谓`Systemless（不修改系统）`
Bloatware Slayer 只是使用了 Magisk 和 KernelSU/APatch 内置的办法，让这些预装 APP 的目录设置为空或者被屏蔽掉，从而使系统不再安装和加载这些软件。
### 2. 即使如此，有些 APP 不应该也不能被随意卸载或屏蔽。
一来是考虑系统稳定性，**部分APP是必须存在才能维护系统正常的运行秩序的APP**——比如说设置和系统界面是在正常生产环境的设备中必须存在的 APP。不过，**这类 APP 数量其实很稀少**，可能整整100个系统 APP 中只有20~30个 APP 属于这一类，大部分系统 APP 事实上并没有多重要，该动手就动手。
二来，某些品牌厂商（MIUI、Huawei、Google）为了持续收集用户信息，会在预装软件中安插一大批看起来 “十分合理” 但是细究起来就是广告毒瘤和信息收集的 APP (Google Play 服务、Google Assistant、应用商店、SystemHelper、AnalysisCore、Joyose)，**这些 APP 被放在系统内置的白名单内，大部分限制对它们而言无效，甚至一旦系统检测到它们被卸载或不存在，就直接拒绝开机或者拒绝提供某些服务。**
### 3. 如果你将某些 APP 加入了 `target.conf` 但是卡在了开机动画甚至是开机第一屏，**要么这些APP是维持系统正常运行秩序所必须的 APP，要么这些APP就是所谓的“一卸载就罢工”的 APP**。
这个时候无论是排除法还是需要进入系统，就需要救砖手段了，以下是一些救砖建议：
1. 对于 Magisk Alpha，当设备两次无法正常进入系统时，在第三次启动就会自动进入安全模式，并禁用所有模块，此时你可以进入并修改 target.conf
2. 对于 KernelSU / APatch，在开机第一屏到开机动画期间可以连续按下音量减键十次左右（连续按，不是长按）,只要你的设备的 KernelSU 内核将救砖模式的代码编译在内，那么有大概率进入 KernelSU / APatch 的安全模式，所有模块会被禁用
3. 对于支持第三方 Recovery 的设备，当你使用 Magisk 时，你也可以直接使用这类 Recovery 的模块管理界面，轻松禁用 Bloatware Slayer。

## Q: 我看到你的仓库里面有 WebUI 的相关组件，为什么正式版里面并没有内置？

### A: 关于 WebUI 支持的说明：暂不考虑。理由如下：1. 我自己用不到，付出与回报不成正比。
Bloatware Slayer 是我写来自用的模块，而我的主要设备用的都是 Magisk Alpha。也就是说，除非使用 KsuWebUI APP，我没有什么机会用到 WebUI，为了这么个我用不到的功能添加 WebUI 恕我真的不能接受。
### 2. 模块会变得过于臃肿，我自己也觉得 WebUI 目前也只是一种炫技，而 Bloatware Slayer 自身变成 Bloatware 一样的东西真的很地狱笑话。
原本 Magisk 模块大小还算适中 (15KB)，加入 WebUI 后，为了在离线状态下也能无间断加载页面，必须把部分资源也一同导入到模块内。
而加了那些离线资源，模块的 zip 文件大小变成 116KB。可想而知，在解压过后只会更得更大；
### 3. WebUI 的引入带来了更多的问题。
为了防止被各类软件轻易检测到 Bloatware Slayer 的存在，Bloatware Slayer 的配置文件一直都放在 `/data/adb/bloatwareslayer/`
在安卓没有相关漏洞的前提下，这个目录在无 Root 权限+ SELinux 强制执行的情况下，普通 APP 是无法访问的。前端的特性注定前端的原生 API 无法访问即使是安卓世界中都要以 root 的身份才能访问的目录，也就是说要想这么做必须用 KernelSU 提供的 API (具体来说就是 ksu.exec )。这既带来了便利，也带来了一定的安全问题和维护难度。目前 Bloatware Slayer 尚不稳定，我实在是不想再开放一个潜在的需要维护的入口。
